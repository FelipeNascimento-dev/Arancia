<div class="user-navbar">
    <div class="macro-guia" id="macroGuia"></div>

    <div class="form-container-center">
        <form method="get" action="" class="form-pesquisa">
            <i class="fa-solid fa-magnifying-glass search-icon-inside"></i>
            <input type="text" name="q" id="q" placeholder="Pesquisar..." value="{{ request.GET.q }}">
        </form>
    </div>

    <div class="items-nav-user">
        <div class="user-dropdown">
            <button class="user-dropdown-toggle" onclick="toggleUserDropdown()">
                <i class="fa fa-user"></i>
                <span class="user-name">{{ request.user.first_name }} - {{ request.user.username }}</span>
                <i class="fa fa-chevron-down arrow-icon"></i>
            </button>

            <ul class="user-dropdown-menu" id="userDropdownMenu">
                <li class="user-greeting">
                    ðŸ‘‹ OlÃ¡, {{ request.user.first_name }} {{ request.user.last_name }}
                </li>
                <hr>
                <li><a href="{% url 'logistica:settings' %}"><i class="fa fa-cog"></i> ConfiguraÃ§Ãµes</a></li>
                <li><a href="#"><i class="fa fa-question-circle"></i> Ajuda</a></li>
                <!-- {% if perms.auth.add_user %}
                    <li><a href="{% url 'logistica:register' %}"><i class="fa-solid fa-user-plus"></i>Cadastrar UsuÃ¡rio</a></li>
                {% endif %} -->
                <li><a href="{% url 'logistica:logout_confirm' %}"><i class="fa fa-sign-out-alt"></i> Sair</a></li>
            </ul>
        </div>
    </div>
</div>

<script>
    function toggleUserDropdown() {
        const menu = document.getElementById('userDropdownMenu');
        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    }

    document.addEventListener('click', function (e) {
        const button = document.querySelector('.user-dropdown-toggle');
        const menu = document.getElementById('userDropdownMenu');
        if (!button.contains(e.target) && !menu.contains(e.target)) {
            menu.style.display = 'none';
        }
    });
</script>