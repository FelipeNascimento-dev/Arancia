{% extends "global/base.html" %}
{% block content %}

<h2 class="title-skill-ger"><i class="fa-solid fa-layer-group"></i> Gestão de Informações Adicionais</h2>

<div class="grid-container">

    <div class="box">
        <h3>Grupos Existentes</h3>

        <ul>
            {% for g in grupos %}
            <li>
                <a href="?group_id={{ g.id }}"
                    class="{% if selected_group and g.id == selected_group.id %}active{% endif %}">
                    {{ g.nome }} ({{ g.userdesignation_set.count }} usuários)
                </a>
            </li>
            {% empty %}
            <li class="muted">Nenhum grupo cadastrado.</li>
            {% endfor %}
        </ul>
    </div>

    <div class="box">
        <h3>Criar Novo Grupo</h3>
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="create_group" value="1">
            <div class="form-group">
                <label for="nome">Nome:</label>
                <input type="text" name="nome" required>
            </div>
            <div class="form-group">
                <label for="cod_iata">Código IATA:</label>
                <input type="text" name="cod_iata">
            </div>
            <div class="form-group">
                <label for="sales_channel">Canal:</label>
                <input type="text" name="sales_channel">
            </div>
            <div class="form-group">
                <label for="deposito">Depósito:</label>
                <input type="text" name="deposito">
            </div>
            <div class="form-group">
                <label for="logradouro">Logradouro:</label>
                <input type="text" name="logradouro">
            </div>
            <div class="form-group">
                <label for="numero">Número:</label>
                <input type="text" name="numero">
            </div>
            <div class="form-group">
                <label for="complemento">Complemento:</label>
                <input type="text" name="complemento">
            </div>
            <div class="form-group">
                <label for="bairro">Bairro:</label>
                <input type="text" name="bairro">
            </div>
            <div class="form-group">
                <label for="cidade">Cidade:</label>
                <input type="text" name="cidade">
            </div>
            <div class="form-group">
                <label for="estado">Estado:</label>
                <input type="text" name="estado">
            </div>
            <div class="form-group">
                <label for="cep">CEP:</label>
                <input type="text" name="cep">
            </div>
            <div class="form-group">
                <label for="telefone1">Telefone1:</label>
                <input type="text" name="telefone1">
            </div>
            <div class="form-group">
                <label for="telefone2">Telefone2:</label>
                <input type="text" name="telefone2">
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" name="email">
            </div>
            <div class="form-group">
                <label for="responsavel">Responsável:</label>
                <input type="text" name="responsavel">
            </div>      
            <button type="submit" class="btn btn-primary">Salvar</button>
        </form>
    </div>

    {% if selected_group %}
    <div class="box wide">
        <h3>Gerenciar Usuários - {{ selected_group.nome }}</h3>

        <h4>Usuários vinculados:</h4>
        <ul>
            {% for u in usuarios_vinculados %}
            <li>{{ u.username }} - {{ u.get_full_name }}</li>
            {% empty %}
            <li class="muted">Nenhum usuário vinculado.</li>
            {% endfor %}
        </ul>

        <h4>Vincular novo usuário:</h4>
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="add_user" value="1">
            <select name="user_id" required>
                <option value="">-- selecione --</option>
                {% for u in all_users %}
                <option value="{{ u.id }}">{{ u.username }} - {{ u.get_full_name }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="btn btn-primary">Vincular</button>
        </form>
    </div>
    {% endif %}
</div>

{% endblock %}